<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.future.my.dao.StationDAO">
    
    <!-- 대여소 삽입 -->
    <insert id="insertStation" parameterType="com.future.my.vo.StationVO">
        INSERT INTO TASHU_STATION (
            STATION_ID, STATION_NAME, X_POS, Y_POS, PARKING_COUNT, 
            RACK_TOT_CNT, RACK_USE_CNT, ADDRESS, NAME_EN, NAME_CN, 
            STATUS, CREATE_DATE, UPDATE_DATE
        ) VALUES (
            #{stationId}, #{stationName}, #{xPos}, #{yPos}, #{parkingCount},
            #{rackTotCnt}, #{rackUseCnt}, #{address}, #{nameEn}, #{nameCn},
            #{status}, #{createDate}, #{updateDate}
        )
    </insert>
    
    <!-- 대여소 ID로 조회 -->
    <select id="selectStationById" parameterType="string" resultType="com.future.my.vo.StationVO">
        SELECT * FROM TASHU_STATION WHERE STATION_ID = #{stationId}
    </select>
    
    <!-- 모든 대여소 조회 -->
    <select id="selectAllStations" resultType="com.future.my.vo.StationVO">
        SELECT * FROM TASHU_STATION ORDER BY STATION_NAME
    </select>
    
    <!-- 대여소 정보 수정 -->
    <update id="updateStation" parameterType="com.future.my.vo.StationVO">
        UPDATE TASHU_STATION SET
            STATION_NAME = #{stationName},
            X_POS = #{xPos},
            Y_POS = #{yPos},
            PARKING_COUNT = #{parkingCount},
            RACK_TOT_CNT = #{rackTotCnt},
            RACK_USE_CNT = #{rackUseCnt},
            ADDRESS = #{address},
            NAME_EN = #{nameEn},
            NAME_CN = #{nameCn},
            STATUS = #{status},
            UPDATE_DATE = #{updateDate}
        WHERE STATION_ID = #{stationId}
    </update>
    
    <!-- 대여소 삭제 -->
    <delete id="deleteStation" parameterType="string">
        DELETE FROM TASHU_STATION WHERE STATION_ID = #{stationId}
    </delete>
    
    <!-- 즐겨찾기 대여소 조회 -->
    <select id="selectFavoriteStations" parameterType="string" resultType="com.future.my.vo.StationVO">
        SELECT s.* FROM TASHU_STATION s
        INNER JOIN TASHU_FAVORITE f ON s.STATION_ID = f.STATION_ID
        WHERE f.USER_ID = #{userId}
        ORDER BY s.STATION_NAME
    </select>
    
    <!-- 즐겨찾기 추가 -->
    <insert id="insertFavorite">
        INSERT INTO TASHU_FAVORITE (FAVORITE_ID, USER_ID, STATION_ID, CREATE_DATE)
        VALUES (#{userId}_#{stationId}, #{userId}, #{stationId}, SYSDATE)
    </insert>
    
    <!-- 즐겨찾기 삭제 -->
    <delete id="deleteFavorite">
        DELETE FROM TASHU_FAVORITE WHERE USER_ID = #{userId} AND STATION_ID = #{stationId}
    </delete>
    
</mapper>